//Nonrecursive implementation
//No intermediate storage
